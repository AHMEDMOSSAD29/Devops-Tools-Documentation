pipeline {
    agent any

    stages {
      
      stage('Delete Cluster') {
        steps {
          // You will need to install CloudBees AWS Credentials Plugin in Jenkins and add AWS Credentials first 
            withCredentials([[
              $class: 'AmazonWebServicesCredentialsBinding',
              credentialsId: "aws-credentials",
              accessKeyVariable: 'AWS_ACCESS_KEY_ID',
              secretKeyVariable: 'AWS_SECRET_ACCESS_KEY'
              ]]) {
              sh "eksctl delete cluster --name kasten-cluster --region eu-central-1"
            }
        }
      }
    }
}